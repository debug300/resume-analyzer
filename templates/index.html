<!DOCTYPE html>
<html>
<head>
    <title>ATS Resume Analyzer</title>
    <style>
        body { font-family: Arial; background:#f4f6f9; }
        .container { width:70%; margin:auto; background:white; padding:25px; border-radius:10px; }
        .bar { background:#ddd; border-radius:20px; overflow:hidden; }
        .fill { height:30px; width:0; color:white; text-align:center; line-height:30px; font-weight:bold; transition:1.2s; }
        .tag { padding:6px 12px; margin:4px; border-radius:15px; display:inline-block; color:white; }
        .green { background:#28a745; }
        .red { background:#dc3545; }
    </style>
</head>

<body>
<div class="container">
    <h2>AI ATS Resume Analyzer</h2>

    {% if error %}
        <p style="color:red">{{ error }}</p>
    {% endif %}

    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="resume" required><br><br>
        <textarea name="jd" rows="6" style="width:100%" placeholder="Paste job description..." required></textarea><br><br>
        <button type="submit">Analyze</button>
    </form>

    {% if score %}
        <hr>
        <h3>ATS Score</h3>

        <div class="bar">
            <div class="fill" id="scoreBar" data-score="{{ score }}">{{ score }}%</div>
        </div>

        <ul>
            <li>Skill Match: {{ skill_score }}%</li>
            <li>Content Similarity: {{ similarity_score }}%</li>
            <li>Keyword Coverage: {{ keyword_score }}%</li>
        </ul>

        <h4>Matched Skills</h4>
        {% for s in matched %}
            <span class="tag green">{{ s }}</span>
        {% endfor %}

        <h4>Missing Skills</h4>
        {% for s in missing %}
            <span class="tag red">{{ s }}</span>
        {% endfor %}

        <h4>Why ATS Deducted Points</h4>
        <ul>
            {% for r in reasons %}
                <li>{{ r }}</li>
            {% endfor %}
        </ul>

        <h4>How to Improve</h4>
        <ul>
            {% for tip in suggestions %}
                <li>{{ tip }}</li>
            {% endfor %}
        </ul>
    {% endif %}
</div>

<script>
    const bar = document.getElementById("scoreBar");
    if (bar) {
        const score = parseFloat(bar.dataset.score);
        bar.style.background = score < 40 ? "#dc3545" : score < 70 ? "#ffc107" : "#28a745";
        setTimeout(() => bar.style.width = score + "%", 200);
    }
</script>
</body>
</html>
